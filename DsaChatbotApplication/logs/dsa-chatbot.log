2025-11-14T10:57:36.892+04:00  INFO 2424 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Starting DsaChatbotApplication using Java 21.0.3 with PID 2424 (C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication\target\classes started by Ogtay Safaraliyev in C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication)
2025-11-14T10:57:36.896+04:00  INFO 2424 --- [main] az.dsa.chatbot.DsaChatbotApplication     : No active profile set, falling back to 1 default profile: "default"
2025-11-14T10:57:37.763+04:00  INFO 2424 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-14T10:57:37.835+04:00  INFO 2424 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 65 ms. Found 11 JPA repository interfaces.
2025-11-14T10:57:38.320+04:00  INFO 2424 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2025-11-14T10:57:38.328+04:00  INFO 2424 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-14T10:57:38.328+04:00  INFO 2424 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2025-11-14T10:57:38.426+04:00  INFO 2424 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-14T10:57:38.426+04:00  INFO 2424 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1496 ms
2025-11-14T10:57:38.638+04:00  INFO 2424 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-14T10:57:38.710+04:00  INFO 2424 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.2.Final
2025-11-14T10:57:38.713+04:00  INFO 2424 --- [main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2025-11-14T10:57:38.842+04:00  INFO 2424 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T10:57:38.963+04:00  INFO 2424 --- [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-14T10:57:38.977+04:00  INFO 2424 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-14T10:57:39.113+04:00  INFO 2424 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4bab78ce
2025-11-14T10:57:39.114+04:00  INFO 2424 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-14T10:57:39.146+04:00  INFO 2424 --- [main] org.hibernate.orm.dialect                : HHH035001: Using dialect: org.hibernate.dialect.PostgreSQLDialect, version: org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$DialectResolutionInfoImpl@a0e33db
2025-11-14T10:57:39.367+04:00  INFO 2424 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T10:57:40.049+04:00  INFO 2424 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-11-14T10:57:40.111+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.122+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.123+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.124+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.125+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column conversation_history set data type JSONB
2025-11-14T10:57:40.125+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.126+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column expires_at set data type timestamp(6)
2025-11-14T10:57:40.133+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_activity set data type timestamp(6)
2025-11-14T10:57:40.134+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_message_time set data type timestamp(6)
2025-11-14T10:57:40.134+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column user_data set data type JSONB
2025-11-14T10:57:40.135+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer set data type TEXT
2025-11-14T10:57:40.146+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer_en set data type TEXT
2025-11-14T10:57:40.147+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.147+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question set data type TEXT
2025-11-14T10:57:40.150+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question_en set data type TEXT
2025-11-14T10:57:40.151+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.152+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.graduates 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.152+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.154+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column message set data type TEXT
2025-11-14T10:57:40.155+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column certificates set data type TEXT
2025-11-14T10:57:40.155+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.156+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column description set data type TEXT
2025-11-14T10:57:40.156+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column for_who set data type TEXT
2025-11-14T10:57:40.156+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column information set data type TEXT
2025-11-14T10:57:40.157+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.157+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.158+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column info set data type TEXT
2025-11-14T10:57:40.158+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.159+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column certificates set data type TEXT
2025-11-14T10:57:40.160+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.160+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column description set data type TEXT
2025-11-14T10:57:40.163+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column for_who set data type TEXT
2025-11-14T10:57:40.164+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column information set data type TEXT
2025-11-14T10:57:40.164+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.165+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.165+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column session_hour set data type time(6)
2025-11-14T10:57:40.166+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.167+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column created_at set data type timestamp(6)
2025-11-14T10:57:40.168+04:00 DEBUG 2424 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column updated_at set data type timestamp(6)
2025-11-14T10:57:40.227+04:00  INFO 2424 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T10:57:40.434+04:00  INFO 2424 --- [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-14T10:57:41.317+04:00  WARN 2424 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-14T10:57:41.864+04:00  INFO 2424 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-11-14T10:57:41.926+04:00  INFO 2424 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8081 (http) with context path ''
2025-11-14T10:57:41.939+04:00  INFO 2424 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Started DsaChatbotApplication in 5.379 seconds (process running for 6.044)
2025-11-14T10:57:41.943+04:00  INFO 2424 --- [scheduling-1] a.d.c.service.impl.SessionServiceImpl    : Starting expired sessions cleanup...
2025-11-14T10:57:42.001+04:00 DEBUG 2424 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.expires_at<?
2025-11-14T10:57:42.548+04:00  INFO 2424 --- [RMI TCP Connection(4)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-14T10:57:42.548+04:00  INFO 2424 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-14T10:57:42.549+04:00  INFO 2424 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-14T10:58:00.763+04:00  INFO 2424 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:00.774+04:00 DEBUG 2424 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:00.776+04:00  INFO 2424 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:00.776+04:00 DEBUG 2424 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:00.777+04:00  INFO 2424 --- [http-nio-8081-exec-3] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:00.777+04:00 DEBUG 2424 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:00.784+04:00 DEBUG 2424 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:00.809+04:00 DEBUG 2424 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:00.817+04:00  WARN 2424 --- [http-nio-8081-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:00.817+04:00 ERROR 2424 --- [http-nio-8081-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:00.822+04:00 ERROR 2424 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T10:58:01.991+04:00  INFO 2424 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:01.992+04:00 DEBUG 2424 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:01.993+04:00  INFO 2424 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:01.994+04:00 DEBUG 2424 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:01.995+04:00  INFO 2424 --- [http-nio-8081-exec-5] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:01.995+04:00 DEBUG 2424 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:01.996+04:00 DEBUG 2424 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:01.997+04:00 DEBUG 2424 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:01.998+04:00  WARN 2424 --- [http-nio-8081-exec-5] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:01.998+04:00 ERROR 2424 --- [http-nio-8081-exec-5] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:01.998+04:00 ERROR 2424 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T10:58:03.089+04:00  INFO 2424 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:03.090+04:00 DEBUG 2424 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:03.091+04:00  INFO 2424 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:03.092+04:00 DEBUG 2424 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:03.093+04:00  INFO 2424 --- [http-nio-8081-exec-6] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:03.093+04:00 DEBUG 2424 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:03.094+04:00 DEBUG 2424 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:03.095+04:00 DEBUG 2424 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:03.096+04:00  WARN 2424 --- [http-nio-8081-exec-6] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:03.096+04:00 ERROR 2424 --- [http-nio-8081-exec-6] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:03.096+04:00 ERROR 2424 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T10:58:04.434+04:00  INFO 2424 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:04.435+04:00 DEBUG 2424 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:04.436+04:00  INFO 2424 --- [http-nio-8081-exec-7] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:04.437+04:00 DEBUG 2424 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:04.437+04:00  INFO 2424 --- [http-nio-8081-exec-7] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:04.438+04:00 DEBUG 2424 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:04.438+04:00 DEBUG 2424 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:04.439+04:00 DEBUG 2424 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:04.440+04:00  WARN 2424 --- [http-nio-8081-exec-7] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:04.440+04:00 ERROR 2424 --- [http-nio-8081-exec-7] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:04.441+04:00 ERROR 2424 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T10:58:11.958+04:00  INFO 2424 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:11.959+04:00 DEBUG 2424 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:11.960+04:00  INFO 2424 --- [http-nio-8081-exec-8] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:11.961+04:00 DEBUG 2424 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:11.961+04:00  INFO 2424 --- [http-nio-8081-exec-8] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:11.961+04:00 DEBUG 2424 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:11.962+04:00 DEBUG 2424 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:11.963+04:00 DEBUG 2424 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:11.965+04:00  WARN 2424 --- [http-nio-8081-exec-8] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:11.965+04:00 ERROR 2424 --- [http-nio-8081-exec-8] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:11.965+04:00 ERROR 2424 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T10:58:15.237+04:00  INFO 2424 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T10:58:15.238+04:00 DEBUG 2424 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:15.239+04:00  INFO 2424 --- [http-nio-8081-exec-9] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T10:58:15.239+04:00 DEBUG 2424 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:15.240+04:00  INFO 2424 --- [http-nio-8081-exec-9] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T10:58:15.240+04:00 DEBUG 2424 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:15.241+04:00 DEBUG 2424 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T10:58:15.242+04:00 DEBUG 2424 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T10:58:15.243+04:00  WARN 2424 --- [http-nio-8081-exec-9] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T10:58:15.243+04:00 ERROR 2424 --- [http-nio-8081-exec-9] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T10:58:15.244+04:00 ERROR 2424 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:00:00.030+04:00 DEBUG 2424 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0
2025-11-14T11:01:48.500+04:00  INFO 2424 --- [http-nio-8081-exec-1] o.springdoc.api.AbstractOpenApiResource  : Init duration for springdoc-openapi is: 202 ms
2025-11-14T11:07:03.768+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] inMXBeanRegistrar$SpringApplicationAdmin : Application shutdown requested.
2025-11-14T11:07:03.775+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-11-14T11:07:03.776+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Destroying Spring FrameworkServlet 'dispatcherServlet'
2025-11-14T11:07:03.784+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:07:03.786+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-14T11:07:03.788+04:00  INFO 2424 --- [RMI TCP Connection(15)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-14T11:07:06.367+04:00  INFO 31716 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Starting DsaChatbotApplication using Java 21.0.3 with PID 31716 (C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication\target\classes started by Ogtay Safaraliyev in C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication)
2025-11-14T11:07:06.369+04:00  INFO 31716 --- [main] az.dsa.chatbot.DsaChatbotApplication     : No active profile set, falling back to 1 default profile: "default"
2025-11-14T11:07:07.103+04:00  INFO 31716 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-14T11:07:07.170+04:00  INFO 31716 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 61 ms. Found 11 JPA repository interfaces.
2025-11-14T11:07:07.580+04:00  INFO 31716 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2025-11-14T11:07:07.587+04:00  INFO 31716 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-14T11:07:07.587+04:00  INFO 31716 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2025-11-14T11:07:07.667+04:00  INFO 31716 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-14T11:07:07.667+04:00  INFO 31716 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1268 ms
2025-11-14T11:07:07.840+04:00  INFO 31716 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-14T11:07:07.882+04:00  INFO 31716 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.2.Final
2025-11-14T11:07:07.884+04:00  INFO 31716 --- [main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2025-11-14T11:07:07.985+04:00  INFO 31716 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:07:08.086+04:00  INFO 31716 --- [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-14T11:07:08.099+04:00  INFO 31716 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-14T11:07:08.219+04:00  INFO 31716 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@71f29d91
2025-11-14T11:07:08.220+04:00  INFO 31716 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-14T11:07:08.244+04:00  INFO 31716 --- [main] org.hibernate.orm.dialect                : HHH035001: Using dialect: org.hibernate.dialect.PostgreSQLDialect, version: org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$DialectResolutionInfoImpl@c30f26d
2025-11-14T11:07:08.443+04:00  INFO 31716 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:07:09.067+04:00  INFO 31716 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-11-14T11:07:09.114+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.116+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.117+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.118+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.118+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column conversation_history set data type JSONB
2025-11-14T11:07:09.119+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.119+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column expires_at set data type timestamp(6)
2025-11-14T11:07:09.122+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_activity set data type timestamp(6)
2025-11-14T11:07:09.123+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_message_time set data type timestamp(6)
2025-11-14T11:07:09.123+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column user_data set data type JSONB
2025-11-14T11:07:09.124+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer set data type TEXT
2025-11-14T11:07:09.128+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer_en set data type TEXT
2025-11-14T11:07:09.129+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.130+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question set data type TEXT
2025-11-14T11:07:09.132+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question_en set data type TEXT
2025-11-14T11:07:09.133+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.133+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.graduates 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.134+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.135+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column message set data type TEXT
2025-11-14T11:07:09.136+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column certificates set data type TEXT
2025-11-14T11:07:09.136+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.136+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column description set data type TEXT
2025-11-14T11:07:09.137+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column for_who set data type TEXT
2025-11-14T11:07:09.137+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column information set data type TEXT
2025-11-14T11:07:09.137+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.138+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.138+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column info set data type TEXT
2025-11-14T11:07:09.139+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.140+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column certificates set data type TEXT
2025-11-14T11:07:09.140+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.141+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column description set data type TEXT
2025-11-14T11:07:09.143+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column for_who set data type TEXT
2025-11-14T11:07:09.143+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column information set data type TEXT
2025-11-14T11:07:09.144+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.145+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.145+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column session_hour set data type time(6)
2025-11-14T11:07:09.146+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.147+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column created_at set data type timestamp(6)
2025-11-14T11:07:09.147+04:00 DEBUG 31716 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:07:09.202+04:00  INFO 31716 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:07:09.398+04:00  INFO 31716 --- [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-14T11:07:10.171+04:00  WARN 31716 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-14T11:07:10.665+04:00  INFO 31716 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-11-14T11:07:10.728+04:00  INFO 31716 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8081 (http) with context path ''
2025-11-14T11:07:10.740+04:00  INFO 31716 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Started DsaChatbotApplication in 4.65 seconds (process running for 5.219)
2025-11-14T11:07:10.745+04:00  INFO 31716 --- [scheduling-1] a.d.c.service.impl.SessionServiceImpl    : Starting expired sessions cleanup...
2025-11-14T11:07:10.796+04:00 DEBUG 31716 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.expires_at<?
2025-11-14T11:07:10.925+04:00  INFO 31716 --- [RMI TCP Connection(4)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-14T11:07:10.925+04:00  INFO 31716 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-14T11:07:10.926+04:00  INFO 31716 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 0 ms
2025-11-14T11:07:41.120+04:00  INFO 31716 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:07:41.130+04:00 DEBUG 31716 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:41.131+04:00  INFO 31716 --- [http-nio-8081-exec-4] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:07:41.132+04:00 DEBUG 31716 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:41.133+04:00  INFO 31716 --- [http-nio-8081-exec-4] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:07:41.133+04:00 DEBUG 31716 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:41.141+04:00 DEBUG 31716 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:41.165+04:00 DEBUG 31716 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:07:41.170+04:00  WARN 31716 --- [http-nio-8081-exec-4] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:07:41.170+04:00 ERROR 31716 --- [http-nio-8081-exec-4] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:07:41.175+04:00 ERROR 31716 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:07:47.453+04:00  INFO 31716 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:07:47.454+04:00 DEBUG 31716 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:47.455+04:00  INFO 31716 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:07:47.456+04:00 DEBUG 31716 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:47.457+04:00  INFO 31716 --- [http-nio-8081-exec-5] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:07:47.457+04:00 DEBUG 31716 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:47.458+04:00 DEBUG 31716 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:07:47.460+04:00 DEBUG 31716 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:07:47.461+04:00  WARN 31716 --- [http-nio-8081-exec-5] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:07:47.461+04:00 ERROR 31716 --- [http-nio-8081-exec-5] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:07:47.461+04:00 ERROR 31716 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:08:03.993+04:00  INFO 31716 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:08:03.994+04:00 DEBUG 31716 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:03.995+04:00  INFO 31716 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:08:03.996+04:00 DEBUG 31716 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:03.996+04:00  INFO 31716 --- [http-nio-8081-exec-6] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:08:03.997+04:00 DEBUG 31716 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:03.998+04:00 DEBUG 31716 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:04.000+04:00 DEBUG 31716 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:08:04.001+04:00  WARN 31716 --- [http-nio-8081-exec-6] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:08:04.001+04:00 ERROR 31716 --- [http-nio-8081-exec-6] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:08:04.002+04:00 ERROR 31716 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:08:05.123+04:00  INFO 31716 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:08:05.124+04:00 DEBUG 31716 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:05.125+04:00  INFO 31716 --- [http-nio-8081-exec-7] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:08:05.125+04:00 DEBUG 31716 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:05.126+04:00  INFO 31716 --- [http-nio-8081-exec-7] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:08:05.126+04:00 DEBUG 31716 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:05.127+04:00 DEBUG 31716 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:05.128+04:00 DEBUG 31716 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:08:05.129+04:00  WARN 31716 --- [http-nio-8081-exec-7] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:08:05.129+04:00 ERROR 31716 --- [http-nio-8081-exec-7] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:08:05.130+04:00 ERROR 31716 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:08:06.245+04:00  INFO 31716 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:08:06.247+04:00 DEBUG 31716 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:06.248+04:00  INFO 31716 --- [http-nio-8081-exec-8] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:08:06.248+04:00 DEBUG 31716 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:06.249+04:00  INFO 31716 --- [http-nio-8081-exec-8] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:08:06.249+04:00 DEBUG 31716 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:06.250+04:00 DEBUG 31716 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:06.250+04:00 DEBUG 31716 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:08:06.251+04:00  WARN 31716 --- [http-nio-8081-exec-8] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:08:06.251+04:00 ERROR 31716 --- [http-nio-8081-exec-8] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:08:06.252+04:00 ERROR 31716 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:08:07.078+04:00  INFO 31716 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:08:07.079+04:00 DEBUG 31716 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:07.080+04:00  INFO 31716 --- [http-nio-8081-exec-9] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:08:07.080+04:00 DEBUG 31716 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:07.081+04:00  INFO 31716 --- [http-nio-8081-exec-9] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:08:07.081+04:00 DEBUG 31716 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:07.082+04:00 DEBUG 31716 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:08:07.083+04:00 DEBUG 31716 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:08:07.084+04:00  WARN 31716 --- [http-nio-8081-exec-9] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:08:07.084+04:00 ERROR 31716 --- [http-nio-8081-exec-9] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:08:07.085+04:00 ERROR 31716 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:08:59.350+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] inMXBeanRegistrar$SpringApplicationAdmin : Application shutdown requested.
2025-11-14T11:08:59.357+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-11-14T11:08:59.358+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Destroying Spring FrameworkServlet 'dispatcherServlet'
2025-11-14T11:08:59.364+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:08:59.366+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-14T11:08:59.369+04:00  INFO 31716 --- [RMI TCP Connection(7)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-14T11:09:01.791+04:00  INFO 26348 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Starting DsaChatbotApplication using Java 21.0.3 with PID 26348 (C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication\target\classes started by Ogtay Safaraliyev in C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication)
2025-11-14T11:09:01.792+04:00  INFO 26348 --- [main] az.dsa.chatbot.DsaChatbotApplication     : No active profile set, falling back to 1 default profile: "default"
2025-11-14T11:09:02.501+04:00  INFO 26348 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-14T11:09:02.571+04:00  INFO 26348 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 64 ms. Found 11 JPA repository interfaces.
2025-11-14T11:09:02.970+04:00  INFO 26348 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2025-11-14T11:09:02.977+04:00  INFO 26348 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-14T11:09:02.977+04:00  INFO 26348 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2025-11-14T11:09:03.057+04:00  INFO 26348 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-14T11:09:03.057+04:00  INFO 26348 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1232 ms
2025-11-14T11:09:03.226+04:00  INFO 26348 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-14T11:09:03.268+04:00  INFO 26348 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.2.Final
2025-11-14T11:09:03.270+04:00  INFO 26348 --- [main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2025-11-14T11:09:03.372+04:00  INFO 26348 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:09:03.469+04:00  INFO 26348 --- [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-14T11:09:03.482+04:00  INFO 26348 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-14T11:09:03.597+04:00  INFO 26348 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@a63643e
2025-11-14T11:09:03.599+04:00  INFO 26348 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-14T11:09:03.623+04:00  INFO 26348 --- [main] org.hibernate.orm.dialect                : HHH035001: Using dialect: org.hibernate.dialect.PostgreSQLDialect, version: org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$DialectResolutionInfoImpl@2a984952
2025-11-14T11:09:03.823+04:00  INFO 26348 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:09:04.435+04:00  INFO 26348 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-11-14T11:09:04.477+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.479+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.480+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.481+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.481+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column conversation_history set data type JSONB
2025-11-14T11:09:04.482+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.482+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column expires_at set data type timestamp(6)
2025-11-14T11:09:04.485+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_activity set data type timestamp(6)
2025-11-14T11:09:04.486+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_message_time set data type timestamp(6)
2025-11-14T11:09:04.486+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column user_data set data type JSONB
2025-11-14T11:09:04.487+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer set data type TEXT
2025-11-14T11:09:04.491+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer_en set data type TEXT
2025-11-14T11:09:04.491+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.492+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question set data type TEXT
2025-11-14T11:09:04.495+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question_en set data type TEXT
2025-11-14T11:09:04.495+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.496+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.graduates 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.497+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.498+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column message set data type TEXT
2025-11-14T11:09:04.499+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column certificates set data type TEXT
2025-11-14T11:09:04.499+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.499+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column description set data type TEXT
2025-11-14T11:09:04.500+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column for_who set data type TEXT
2025-11-14T11:09:04.500+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column information set data type TEXT
2025-11-14T11:09:04.500+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.501+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.501+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column info set data type TEXT
2025-11-14T11:09:04.502+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.503+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column certificates set data type TEXT
2025-11-14T11:09:04.503+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.504+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column description set data type TEXT
2025-11-14T11:09:04.507+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column for_who set data type TEXT
2025-11-14T11:09:04.507+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column information set data type TEXT
2025-11-14T11:09:04.508+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.509+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.509+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column session_hour set data type time(6)
2025-11-14T11:09:04.510+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.510+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column created_at set data type timestamp(6)
2025-11-14T11:09:04.511+04:00 DEBUG 26348 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:09:04.567+04:00  INFO 26348 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:09:04.754+04:00  INFO 26348 --- [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-14T11:09:05.517+04:00  WARN 26348 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-14T11:09:06.009+04:00  INFO 26348 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-11-14T11:09:06.068+04:00  INFO 26348 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8081 (http) with context path ''
2025-11-14T11:09:06.080+04:00  INFO 26348 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Started DsaChatbotApplication in 4.567 seconds (process running for 5.127)
2025-11-14T11:09:06.085+04:00  INFO 26348 --- [scheduling-1] a.d.c.service.impl.SessionServiceImpl    : Starting expired sessions cleanup...
2025-11-14T11:09:06.139+04:00 DEBUG 26348 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.expires_at<?
2025-11-14T11:09:06.346+04:00  INFO 26348 --- [RMI TCP Connection(4)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-14T11:09:06.346+04:00  INFO 26348 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-14T11:09:06.347+04:00  INFO 26348 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-14T11:10:22.997+04:00  INFO 26348 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:10:23.008+04:00 DEBUG 26348 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:10:23.009+04:00  INFO 26348 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:10:23.010+04:00 DEBUG 26348 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:10:23.010+04:00  INFO 26348 --- [http-nio-8081-exec-3] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:10:23.011+04:00 DEBUG 26348 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:10:23.021+04:00 DEBUG 26348 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:10:23.045+04:00 DEBUG 26348 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:10:23.050+04:00  WARN 26348 --- [http-nio-8081-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 0, SQLState: 42804
2025-11-14T11:10:23.051+04:00 ERROR 26348 --- [http-nio-8081-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
2025-11-14T11:10:23.055+04:00 ERROR 26348 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Error processing chat: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]

org.springframework.dao.InvalidDataAccessResourceUsageException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]; SQL [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:229) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:565) ~[spring-orm-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:660) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:410) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:750) ~[spring-aop-6.0.9.jar:6.0.9]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:702) ~[spring-aop-6.0.9.jar:6.0.9]
	at az.dsa.chatbot.service.impl.SessionServiceImpl$$SpringCGLIB$$0.getOrCreateSession(<generated>) ~[classes/:na]
	at az.dsa.chatbot.service.impl.ChatServiceImpl.processMessage(ChatServiceImpl.java:94) ~[classes/:na]
	at az.dsa.chatbot.controller.ChatController.chat(ChatController.java:111) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1081) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:974) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.0.9.jar:6.0.9]
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.8.jar:6.0]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:205) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at az.dsa.chatbot.config.ApiKeyAuthenticationFilter.doFilterInternal(ApiKeyAuthenticationFilter.java:51) ~[classes/:na]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:109) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.0.9.jar:6.0.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.0.9.jar:6.0.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:174) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:149) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:166) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:341) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:390) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:894) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-10.1.8.jar:10.1.8]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213] [insert into dsa_chatbot_db.chat_sessions (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) values (?,?,?,?,?,?,?,?,?,?,?,?,?)]
	at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:89) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:56) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:278) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:108) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:40) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:53) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.doStaticInserts(InsertCoordinator.java:170) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.mutation.InsertCoordinator.coordinateInsert(InsertCoordinator.java:112) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2670) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.action.internal.EntityInsertAction.execute(EntityInsertAction.java:102) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:618) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.spi.ActionQueue.lambda$executeActions$1(ActionQueue.java:489) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:986) ~[na:na]
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:486) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:358) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1412) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:485) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2296) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:1961) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:439) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:169) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:267) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:561) ~[spring-orm-6.0.9.jar:6.0.9]
	... 67 common frames omitted
Caused by: org.postgresql.util.PSQLException: ERROR: column "conversation_history" is of type jsonb but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 213
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2713) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2401) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:368) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190) ~[postgresql-42.6.0.jar:42.6.0]
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152) ~[postgresql-42.6.0.jar:42.6.0]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-5.0.1.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-5.0.1.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:275) ~[hibernate-core-6.2.2.Final.jar:6.2.2.Final]
	... 90 common frames omitted

2025-11-14T11:21:47.172+04:00  INFO 3936 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Starting DsaChatbotApplication using Java 21.0.3 with PID 3936 (C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication\target\classes started by Ogtay Safaraliyev in C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication)
2025-11-14T11:21:47.173+04:00  INFO 3936 --- [main] az.dsa.chatbot.DsaChatbotApplication     : No active profile set, falling back to 1 default profile: "default"
2025-11-14T11:21:47.862+04:00  INFO 3936 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-14T11:21:47.927+04:00  INFO 3936 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 59 ms. Found 11 JPA repository interfaces.
2025-11-14T11:21:48.327+04:00  INFO 3936 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2025-11-14T11:21:48.334+04:00  INFO 3936 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-14T11:21:48.334+04:00  INFO 3936 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2025-11-14T11:21:48.414+04:00  INFO 3936 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-14T11:21:48.414+04:00  INFO 3936 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1211 ms
2025-11-14T11:21:48.578+04:00  INFO 3936 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-14T11:21:48.624+04:00  INFO 3936 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.2.Final
2025-11-14T11:21:48.626+04:00  INFO 3936 --- [main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2025-11-14T11:21:48.725+04:00  INFO 3936 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:21:48.823+04:00  INFO 3936 --- [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-14T11:21:48.837+04:00  INFO 3936 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-14T11:21:48.952+04:00  INFO 3936 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5ec6a1b6
2025-11-14T11:21:48.954+04:00  INFO 3936 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-14T11:21:48.977+04:00  INFO 3936 --- [main] org.hibernate.orm.dialect                : HHH035001: Using dialect: org.hibernate.dialect.PostgreSQLDialect, version: org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$DialectResolutionInfoImpl@4d174189
2025-11-14T11:21:49.173+04:00  INFO 3936 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:21:49.796+04:00  INFO 3936 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-11-14T11:21:49.836+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.850+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.851+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.852+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.853+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column conversation_history set data type TEXT
2025-11-14T11:21:49.853+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.854+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column expires_at set data type timestamp(6)
2025-11-14T11:21:49.855+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_activity set data type timestamp(6)
2025-11-14T11:21:49.856+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_message_time set data type timestamp(6)
2025-11-14T11:21:49.856+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column user_data set data type TEXT
2025-11-14T11:21:49.856+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer set data type TEXT
2025-11-14T11:21:49.860+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer_en set data type TEXT
2025-11-14T11:21:49.861+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.861+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question set data type TEXT
2025-11-14T11:21:49.864+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question_en set data type TEXT
2025-11-14T11:21:49.864+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.865+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.graduates 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.866+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.867+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column message set data type TEXT
2025-11-14T11:21:49.867+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column certificates set data type TEXT
2025-11-14T11:21:49.868+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.868+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column description set data type TEXT
2025-11-14T11:21:49.868+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column for_who set data type TEXT
2025-11-14T11:21:49.869+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column information set data type TEXT
2025-11-14T11:21:49.869+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.870+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.870+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column info set data type TEXT
2025-11-14T11:21:49.871+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.871+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column certificates set data type TEXT
2025-11-14T11:21:49.872+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.873+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column description set data type TEXT
2025-11-14T11:21:49.875+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column for_who set data type TEXT
2025-11-14T11:21:49.875+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column information set data type TEXT
2025-11-14T11:21:49.876+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.877+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.877+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column session_hour set data type time(6)
2025-11-14T11:21:49.878+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.878+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:49.879+04:00 DEBUG 3936 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:49.934+04:00  INFO 3936 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:21:50.125+04:00  INFO 3936 --- [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-14T11:21:50.900+04:00  WARN 3936 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-14T11:21:51.393+04:00  INFO 3936 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-11-14T11:21:51.441+04:00  WARN 3936 --- [main] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.context.ApplicationContextException: Failed to start bean 'webServerStartStop'
2025-11-14T11:21:51.445+04:00  INFO 3936 --- [main] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:21:51.446+04:00  INFO 3936 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-14T11:21:51.449+04:00  INFO 3936 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-14T11:21:51.451+04:00  INFO 3936 --- [main] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-11-14T11:21:51.463+04:00  INFO 3936 --- [main] .s.b.a.l.ConditionEvaluationReportLogger : 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-11-14T11:21:51.476+04:00 ERROR 3936 --- [main] o.s.b.d.LoggingFailureAnalysisReporter   : 

***************************
APPLICATION FAILED TO START
***************************

Description:

Web server failed to start. Port 8081 was already in use.

Action:

Identify and stop the process that's listening on port 8081 or configure this application to listen on another port.

2025-11-14T11:21:53.733+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] inMXBeanRegistrar$SpringApplicationAdmin : Application shutdown requested.
2025-11-14T11:21:53.741+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
2025-11-14T11:21:53.742+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Destroying Spring FrameworkServlet 'dispatcherServlet'
2025-11-14T11:21:53.751+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:21:53.753+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2025-11-14T11:21:53.756+04:00  INFO 26348 --- [RMI TCP Connection(19)-127.0.0.1] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2025-11-14T11:21:56.145+04:00  INFO 7140 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Starting DsaChatbotApplication using Java 21.0.3 with PID 7140 (C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication\target\classes started by Ogtay Safaraliyev in C:\Users\Ogtay Safaraliyev\git\DSAChatbotApp\DsaChatbotApplication)
2025-11-14T11:21:56.148+04:00  INFO 7140 --- [main] az.dsa.chatbot.DsaChatbotApplication     : No active profile set, falling back to 1 default profile: "default"
2025-11-14T11:21:56.853+04:00  INFO 7140 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-14T11:21:56.917+04:00  INFO 7140 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 58 ms. Found 11 JPA repository interfaces.
2025-11-14T11:21:57.316+04:00  INFO 7140 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8081 (http)
2025-11-14T11:21:57.323+04:00  INFO 7140 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-11-14T11:21:57.323+04:00  INFO 7140 --- [main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.8]
2025-11-14T11:21:57.401+04:00  INFO 7140 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-11-14T11:21:57.401+04:00  INFO 7140 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1221 ms
2025-11-14T11:21:57.570+04:00  INFO 7140 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-14T11:21:57.612+04:00  INFO 7140 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 6.2.2.Final
2025-11-14T11:21:57.614+04:00  INFO 7140 --- [main] org.hibernate.cfg.Environment            : HHH000406: Using bytecode reflection optimizer
2025-11-14T11:21:57.715+04:00  INFO 7140 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:21:57.816+04:00  INFO 7140 --- [main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-14T11:21:57.829+04:00  INFO 7140 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2025-11-14T11:21:57.945+04:00  INFO 7140 --- [main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@5ec6a1b6
2025-11-14T11:21:57.946+04:00  INFO 7140 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2025-11-14T11:21:57.970+04:00  INFO 7140 --- [main] org.hibernate.orm.dialect                : HHH035001: Using dialect: org.hibernate.dialect.PostgreSQLDialect, version: org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator$DialectResolutionInfoImpl@4d174189
2025-11-14T11:21:58.174+04:00  INFO 7140 --- [main] o.h.b.i.BytecodeProviderInitiator        : HHH000021: Bytecode provider name : bytebuddy
2025-11-14T11:21:58.783+04:00  INFO 7140 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2025-11-14T11:21:58.821+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.823+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamp_types 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.824+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.825+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.bootcamps 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.825+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column conversation_history set data type TEXT
2025-11-14T11:21:58.826+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.826+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column expires_at set data type timestamp(6)
2025-11-14T11:21:58.828+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_activity set data type timestamp(6)
2025-11-14T11:21:58.829+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column last_message_time set data type timestamp(6)
2025-11-14T11:21:58.829+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.chat_sessions 
       alter column user_data set data type TEXT
2025-11-14T11:21:58.830+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer set data type TEXT
2025-11-14T11:21:58.834+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column answer_en set data type TEXT
2025-11-14T11:21:58.834+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.835+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question set data type TEXT
2025-11-14T11:21:58.837+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column question_en set data type TEXT
2025-11-14T11:21:58.838+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.faq 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.839+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.graduates 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.840+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.840+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.leads 
       alter column message set data type TEXT
2025-11-14T11:21:58.841+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column certificates set data type TEXT
2025-11-14T11:21:58.841+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.842+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column description set data type TEXT
2025-11-14T11:21:58.842+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column for_who set data type TEXT
2025-11-14T11:21:58.843+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column information set data type TEXT
2025-11-14T11:21:58.843+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.metinler 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.844+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.844+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column info set data type TEXT
2025-11-14T11:21:58.845+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainers 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.845+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column certificates set data type TEXT
2025-11-14T11:21:58.846+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.846+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column description set data type TEXT
2025-11-14T11:21:58.848+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column for_who set data type TEXT
2025-11-14T11:21:58.849+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column information set data type TEXT
2025-11-14T11:21:58.849+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_details 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.850+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.851+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column session_hour set data type time(6)
2025-11-14T11:21:58.851+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.training_sessions 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.852+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column created_at set data type timestamp(6)
2025-11-14T11:21:58.852+04:00 DEBUG 7140 --- [main] org.hibernate.SQL                        : 
    alter table if exists dsa_chatbot_db.trainings 
       alter column updated_at set data type timestamp(6)
2025-11-14T11:21:58.907+04:00  INFO 7140 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-14T11:21:59.098+04:00  INFO 7140 --- [main] o.s.d.j.r.query.QueryEnhancerFactory     : Hibernate is in classpath; If applicable, HQL parser will be used.
2025-11-14T11:21:59.870+04:00  WARN 7140 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-14T11:22:00.365+04:00  INFO 7140 --- [main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path '/actuator'
2025-11-14T11:22:00.430+04:00  INFO 7140 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8081 (http) with context path ''
2025-11-14T11:22:00.443+04:00  INFO 7140 --- [main] az.dsa.chatbot.DsaChatbotApplication     : Started DsaChatbotApplication in 4.574 seconds (process running for 5.125)
2025-11-14T11:22:00.447+04:00  INFO 7140 --- [scheduling-1] a.d.c.service.impl.SessionServiceImpl    : Starting expired sessions cleanup...
2025-11-14T11:22:00.498+04:00 DEBUG 7140 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.expires_at<?
2025-11-14T11:22:00.879+04:00  INFO 7140 --- [RMI TCP Connection(4)-127.0.0.1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-14T11:22:00.879+04:00  INFO 7140 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-11-14T11:22:00.880+04:00  INFO 7140 --- [RMI TCP Connection(4)-127.0.0.1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 1 ms
2025-11-14T11:22:10.108+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:10.119+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:10.121+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:10.121+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:10.122+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.SessionServiceImpl    : Creating new session: web-****ycwl
2025-11-14T11:22:10.123+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:10.130+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:10.156+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.chat_sessions
        (conversation_history,created_at,current_mode,current_step,expires_at,ip_address,is_blocked,last_activity,last_message_time,message_count,user_agent,user_data,id) 
    values
        (?,?,?,?,?,?,?,?,?,?,?,?,?)
2025-11-14T11:22:11.904+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:11.909+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:22:15.979+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:15.981+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:15.998+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:17.448+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Detected intent: QUERY
2025-11-14T11:22:17.448+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Handling query: Tlimlr haqqnda.
2025-11-14T11:22:17.457+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        f1_0.id,
        f1_0.answer,
        f1_0.answer_en,
        f1_0.created_at,
        f1_0.question,
        f1_0.question_en,
        f1_0.updated_at 
    from
        dsa_chatbot_db.faq f1_0 
    where
        lower(f1_0.question) like lower(('%'||?||'%')) escape '' 
        or lower(f1_0.answer) like lower(('%'||?||'%')) escape ''
2025-11-14T11:22:17.465+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.money,
        t1_0.title,
        t1_0.trainings_id,
        t1_0.updated_at 
    from
        dsa_chatbot_db.metinler t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.description) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.information) like lower(('%'||?||'%')) escape ''
2025-11-14T11:22:17.474+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.bootcamp_type_id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.order_index,
        t1_0.title,
        t1_0.updated_at 
    from
        dsa_chatbot_db.trainings t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape ''
2025-11-14T11:22:19.865+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:19.876+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:22:23.626+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:23.628+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:23.630+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:24.427+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:24.440+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:22:33.645+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:33.647+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:33.648+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:34.937+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:34.938+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:22:44.849+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:44.851+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:44.852+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:46.197+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Detected intent: CONSULT
2025-11-14T11:22:46.199+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:46.211+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:22:54.573+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:22:54.574+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:22:54.576+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:22:54.578+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:22:54.589+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:23:03.887+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:23:03.888+04:00 DEBUG 7140 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:23:03.890+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:23:03.892+04:00 DEBUG 7140 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:23:03.904+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:23:15.700+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:23:15.701+04:00 DEBUG 7140 --- [http-nio-8081-exec-10] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:23:15.703+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:23:15.705+04:00 DEBUG 7140 --- [http-nio-8081-exec-10] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:23:15.719+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:23:21.984+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:23:21.985+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:23:21.987+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:23:21.989+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:23:21.990+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:23:28.336+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:23:28.337+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:23:28.339+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:23:28.339+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Starting recommendation generation for session: web-****ycwl
2025-11-14T11:23:28.339+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.s.impl.RecommendationServiceImpl   : Generating recommendations - Experience: analitika, Interest: Machine Learning, Budget: 500
2025-11-14T11:23:28.342+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.bootcamp_type_id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.order_index,
        t1_0.title,
        t1_0.updated_at 
    from
        dsa_chatbot_db.trainings t1_0 
    where
        t1_0.is_active=true 
    order by
        t1_0.order_index
2025-11-14T11:23:28.365+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.367+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.369+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.371+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.373+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.374+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.375+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.376+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.378+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.379+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.380+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.381+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.381+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.383+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.384+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.385+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.385+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.386+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.387+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.388+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.390+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.390+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.391+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.392+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.392+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.393+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.394+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.395+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.396+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.397+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.397+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.398+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.399+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.399+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.401+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:23:28.402+04:00  INFO 7140 --- [http-nio-8081-exec-2] az.dsa.chatbot.util.TrainingTextMapper   : Initializing Training-Text cache...
2025-11-14T11:23:28.407+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.money,
        t1_0.title,
        t1_0.trainings_id,
        t1_0.updated_at 
    from
        dsa_chatbot_db.metinler t1_0
2025-11-14T11:23:28.408+04:00  INFO 7140 --- [http-nio-8081-exec-2] az.dsa.chatbot.util.TrainingTextMapper   : Cache initialized with 0 mappings
2025-11-14T11:23:28.410+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Recommendations generated successfully - Count: 0
2025-11-14T11:23:28.412+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:23:28.414+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:24:02.938+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:24:02.939+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:24:02.941+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:24:04.230+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Detected intent: QUERY
2025-11-14T11:24:04.230+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Handling query: Tlimlr haqqnda.
2025-11-14T11:24:04.232+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        f1_0.id,
        f1_0.answer,
        f1_0.answer_en,
        f1_0.created_at,
        f1_0.question,
        f1_0.question_en,
        f1_0.updated_at 
    from
        dsa_chatbot_db.faq f1_0 
    where
        lower(f1_0.question) like lower(('%'||?||'%')) escape '' 
        or lower(f1_0.answer) like lower(('%'||?||'%')) escape ''
2025-11-14T11:24:04.236+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.money,
        t1_0.title,
        t1_0.trainings_id,
        t1_0.updated_at 
    from
        dsa_chatbot_db.metinler t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.description) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.information) like lower(('%'||?||'%')) escape ''
2025-11-14T11:24:04.238+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.bootcamp_type_id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.order_index,
        t1_0.title,
        t1_0.updated_at 
    from
        dsa_chatbot_db.trainings t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape ''
2025-11-14T11:24:06.688+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:24:06.700+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:24:29.708+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:24:29.709+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:24:29.710+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:24:30.581+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:24:30.593+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:24:43.814+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:24:43.815+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:24:43.817+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:24:45.554+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Detected intent: CONTACT
2025-11-14T11:24:45.556+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:24:45.567+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:24:56.608+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:24:56.610+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:24:56.611+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:24:56.613+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:24:56.625+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:25:12.582+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:25:12.583+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:25:12.584+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:25:12.602+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        l1_0.id 
    from
        dsa_chatbot_db.leads l1_0 
    where
        l1_0.phone=? fetch first ? rows only
2025-11-14T11:25:12.606+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:25:12.607+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:25:18.752+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:25:18.753+04:00 DEBUG 7140 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:25:18.754+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:25:18.756+04:00 DEBUG 7140 --- [http-nio-8081-exec-9] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:25:18.758+04:00  INFO 7140 --- [http-nio-8081-exec-9] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:25:38.227+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:25:38.229+04:00 DEBUG 7140 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:25:38.230+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:25:38.232+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.d.c.service.impl.LeadServiceImpl       : Saving lead - Phone: +994****09
2025-11-14T11:25:38.235+04:00 DEBUG 7140 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    insert 
    into
        dsa_chatbot_db.leads
        (created_at,email,full_name,message,phone,source) 
    values
        (?,?,?,?,?,?)
2025-11-14T11:25:38.242+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.d.c.service.impl.LeadServiceImpl       : Lead saved successfully with ID: 1
2025-11-14T11:25:38.242+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.d.c.service.impl.ChatServiceImpl       : Lead saved successfully - Name: Samir Alakbarli, Phone: +994****09
2025-11-14T11:25:38.243+04:00 DEBUG 7140 --- [http-nio-8081-exec-8] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:25:38.244+04:00  INFO 7140 --- [http-nio-8081-exec-8] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:26:07.984+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:26:07.985+04:00 DEBUG 7140 --- [http-nio-8081-exec-10] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:26:07.987+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:26:08.847+04:00 DEBUG 7140 --- [http-nio-8081-exec-10] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:26:08.848+04:00  INFO 7140 --- [http-nio-8081-exec-10] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:26:51.765+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:26:51.767+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:26:51.768+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:26:53.451+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.d.c.service.impl.ChatServiceImpl       : Detected intent: CONSULT
2025-11-14T11:26:53.453+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:26:53.465+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:27:01.169+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:27:01.170+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:27:01.172+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:27:01.173+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:27:01.185+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:27:12.589+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:27:12.591+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:27:12.592+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:27:12.595+04:00 DEBUG 7140 --- [http-nio-8081-exec-3] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:27:12.604+04:00  INFO 7140 --- [http-nio-8081-exec-3] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:27:25.215+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:27:25.217+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:27:25.218+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:27:25.220+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:27:25.232+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:27:29.231+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:27:29.232+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:27:29.233+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:27:29.235+04:00 DEBUG 7140 --- [http-nio-8081-exec-5] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:27:29.236+04:00  INFO 7140 --- [http-nio-8081-exec-5] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:27:41.493+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:27:41.494+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:27:41.495+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:27:41.496+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Starting recommendation generation for session: web-****ycwl
2025-11-14T11:27:41.496+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.s.impl.RecommendationServiceImpl   : Generating recommendations - Experience: analitika, Interest: SQL v Data Engineering, Budget: 800
2025-11-14T11:27:41.497+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.bootcamp_type_id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.order_index,
        t1_0.title,
        t1_0.updated_at 
    from
        dsa_chatbot_db.trainings t1_0 
    where
        t1_0.is_active=true 
    order by
        t1_0.order_index
2025-11-14T11:27:41.499+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.500+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.502+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.503+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.509+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.510+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.511+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.511+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.512+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.513+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.513+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.514+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.515+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.516+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.516+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.517+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.517+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.518+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.518+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.519+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.520+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.521+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.522+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.523+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.523+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.524+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.524+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.525+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.525+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.527+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.527+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.528+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.529+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.529+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.530+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.price,
        t1_0.title,
        t2_0.id,
        t2_0.bootcamp_type_id,
        t2_0.created_at,
        t2_0.is_active,
        t2_0.order_index,
        t2_0.title,
        t2_0.updated_at,
        t1_0.updated_at 
    from
        dsa_chatbot_db.training_details t1_0 
    left join
        dsa_chatbot_db.trainings t2_0 
            on t2_0.id=t1_0.training_id 
    where
        t1_0.training_id=?
2025-11-14T11:27:41.530+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.d.c.service.impl.ChatServiceImpl       : Recommendations generated successfully - Count: 0
2025-11-14T11:27:41.533+04:00 DEBUG 7140 --- [http-nio-8081-exec-6] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:27:41.546+04:00  INFO 7140 --- [http-nio-8081-exec-6] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:28:21.855+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:28:21.857+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:28:21.858+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:28:23.322+04:00 DEBUG 7140 --- [http-nio-8081-exec-7] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:28:23.323+04:00  INFO 7140 --- [http-nio-8081-exec-7] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:31:12.911+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:31:12.913+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:31:12.914+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:31:14.454+04:00 DEBUG 7140 --- [http-nio-8081-exec-1] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:31:14.466+04:00  INFO 7140 --- [http-nio-8081-exec-1] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:31:26.560+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:31:26.562+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:31:26.563+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:31:27.857+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Detected intent: QUERY
2025-11-14T11:31:27.857+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.d.c.service.impl.ChatServiceImpl       : Handling query: Tlimlr haqqnda.
2025-11-14T11:31:27.859+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        f1_0.id,
        f1_0.answer,
        f1_0.answer_en,
        f1_0.created_at,
        f1_0.question,
        f1_0.question_en,
        f1_0.updated_at 
    from
        dsa_chatbot_db.faq f1_0 
    where
        lower(f1_0.question) like lower(('%'||?||'%')) escape '' 
        or lower(f1_0.answer) like lower(('%'||?||'%')) escape ''
2025-11-14T11:31:27.862+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.certificate_image,
        t1_0.certificates,
        t1_0.created_at,
        t1_0.description,
        t1_0.for_who,
        t1_0.image,
        t1_0.information,
        t1_0.money,
        t1_0.title,
        t1_0.trainings_id,
        t1_0.updated_at 
    from
        dsa_chatbot_db.metinler t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.description) like lower(('%'||?||'%')) escape '' 
        or lower(t1_0.information) like lower(('%'||?||'%')) escape ''
2025-11-14T11:31:27.864+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    select
        t1_0.id,
        t1_0.bootcamp_type_id,
        t1_0.created_at,
        t1_0.is_active,
        t1_0.order_index,
        t1_0.title,
        t1_0.updated_at 
    from
        dsa_chatbot_db.trainings t1_0 
    where
        lower(t1_0.title) like lower(('%'||?||'%')) escape ''
2025-11-14T11:31:30.119+04:00 DEBUG 7140 --- [http-nio-8081-exec-2] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:31:30.121+04:00  INFO 7140 --- [http-nio-8081-exec-2] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T11:32:41.244+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Received chat request - SessionId: web-****ycwl
2025-11-14T11:32:41.245+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0 
    where
        c1_0.id=?
2025-11-14T11:32:41.247+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.d.c.service.impl.ChatServiceImpl       : Processing message for session: web-****ycwl
2025-11-14T11:32:42.221+04:00 DEBUG 7140 --- [http-nio-8081-exec-4] org.hibernate.SQL                        : 
    update
        dsa_chatbot_db.chat_sessions 
    set
        conversation_history=?,
        current_mode=?,
        current_step=?,
        expires_at=?,
        ip_address=?,
        is_blocked=?,
        last_activity=?,
        last_message_time=?,
        message_count=?,
        user_agent=?,
        user_data=? 
    where
        id=?
2025-11-14T11:32:42.222+04:00  INFO 7140 --- [http-nio-8081-exec-4] a.dsa.chatbot.controller.ChatController  : Chat response sent - SessionId: web-****ycwl
2025-11-14T12:00:00.103+04:00 DEBUG 7140 --- [scheduling-1] org.hibernate.SQL                        : 
    select
        c1_0.id,
        c1_0.conversation_history,
        c1_0.created_at,
        c1_0.current_mode,
        c1_0.current_step,
        c1_0.expires_at,
        c1_0.ip_address,
        c1_0.is_blocked,
        c1_0.last_activity,
        c1_0.last_message_time,
        c1_0.message_count,
        c1_0.user_agent,
        c1_0.user_data 
    from
        dsa_chatbot_db.chat_sessions c1_0
